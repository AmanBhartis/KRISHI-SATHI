import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";

// Your Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyARFZNkjX3_zkKKs4iw2VdNqiB6xHmy1QU",
  authDomain: "krishi-satrhi.firebaseapp.com",
  projectId: "krishi-satrhi",
  storageBucket: "krishi-satrhi.firebasestorage.app",
  messagingSenderId: "466756576499",
  appId: "1:466756576499:web:0199e9a73822f5d9c9c386",
  measurementId: "G-SV54NEQNW8"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

document.querySelector("form").onsubmit = function(e) {
  e.preventDefault();
  const email = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value;
  const msgDiv = document.getElementById("login-msg") || createMsgDiv();

  signInWithEmailAndPassword(auth, email, password)
    .then(() => {
      msgDiv.classList.remove("text-danger");
      msgDiv.classList.add("text-success");
      msgDiv.textContent = "Login successful! Redirecting...";
      setTimeout(() => {
        window.location.href = "dot.html";
      }, 1000);
    })
    .catch(error => {
      msgDiv.classList.remove("text-success");
      msgDiv.classList.add("text-danger");
      msgDiv.textContent = error.message;
    });
};

// Helper to create a message div if not present
function createMsgDiv() {
  const div = document.createElement("div");
  div.id = "login-msg";
  div.className = "mt-3 text-center text-danger";
  document.querySelector(".card").appendChild(div);
  return div;
}


